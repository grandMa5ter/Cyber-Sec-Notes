# Exploit Development

This section is dedicated to things about exploit development and tools that I use to check the files, read binaries, check their security, and some useful functions or oneliners to search inside them.

## Tools

By no means in any order, these are some of the tools that I have came across that come in handy.

- Ghidr
  - Ghidra is a software reverse engineering (SRE) framework created and maintained by the National Security Agency Research Directorate. Windows, Mac OS, and Linux.
- radare2
  - Radare2 is an open source tool to disassemble, debug, analyze and manipulate binary files. It actually supports many architectures (x86{16,32,64}, Dalvik, avr, ARM, java, PowerPC, Sparc, MIPS) and several binary formats (pe{32,64}, [fat]mach0{32,64}, ELF{32,64}, dex and Java classes); [Radare2](https://github.com/radareorg/radare2/blob/master/doc/intro.md)
- Binary Ninja
  - Binary Ninja is a reverse engineering platform. It focuses on a clean and easy to use interface with a powerful multithreaded analysis built on a custom IL to quickly adapt to a variety of architectures, platforms, and compilers. Runs on macOS, Windows, and Linux.
- Hopper
  - Hopper is a reverse engineering tool for macOS and Linux, that lets you disassemble, decompile and debug (OS X only) your 32/64bits Intel Mac, Windows and iOS (ARM) executables.
- x64dbg
  - An open-source x64/x32 debugger for windows.
- ImmunityDbg
  - Immunity Debugger is a branch of OllyDbg v1.10, with built-in support for Python scripting and much more.
- OllyDbg
  - OllyDbg is an assembler level analysing debugger for Microsoft® Windows®. Emphasis on binary code analysis makes it particularly useful in cases where source is unavailable.
- `checksec` to check the security of ELF file
- `readelf` to read the ELF file and understand functions
- GDB as the debugger
- [PawnTools that is a python3](https://docs.pwntools.com/en/stable/install.html) based exploit development tool to create fancy stuff, give this a try.
- [One for All Extension](https://github.com/apogiatzis/gdb-peda-pwndbg-gef) GDB debug assitances for everything you need "PEDA, GEF, Pwndbg" extensions.

## Setting up environment for Reverse Engineering

The setup of environemnt is usually the key to comfort and having the tools and knowing the tools that one can use in order to gain insight and reduce the time spent on mocking around with different things is the key to success in reverse engineering and exploit development.

## Change OllyDbg layout fonts to become readable

Add the following lines to the *.ini file of OllyDbg v2.x to make it more readable or suitable for working with it:

```text
[Colour schemes]
Scheme name[4]=KuNgBiM's Scheme
Foreground_1[4]=*,*,808000,0,FFFF,80,*,FF00,*,FF0000,*,*,*,*,*,*
Foreground_2[4]=*,*,*,*,*,*,*,*,*,*,*,*,*,*,*,*
Background_1[4]=C0DCC0,C0DCC0,C0DCC0,FF00,*,FFFF00,*,*,C0DCC0,FFFF,*,*,*,*,*,*
Background_2[4]=*,*,*,*,*,*,*,*,*,*,*,*,*,*,*,*
Operands[4]=0
Modified commands[4]=0

[Highlighting schemes]
Scheme name[4]=KuNgBiM's Code
Foreground_1[4]=*,*,*,*,*,*,*,*,*,*,*,*,FF0000,FF,FF,FF0000
Foreground_2[4]=0,0,0,FF00,FF,FF,*,*,800000,0,0,800080,FF00FF,80,FF00FF,*
Background_1[4]=*,*,*,*,*,*,*,*,*,*,*,*,*,FFFF,FFFF,*
Background_2[4]=FFFF00,FF00,*,FF,*,*,*,*,*,*,*,*,*,*,*,*
Operands[4]=1
Modified commands[4]=0

[Fonts]
Font name[5]=KuNgBiM's Fonts
Font data[5]=-12,0,400,0,0,0,134,1,49,0,0,0
Face name[5]=#65B0#5B8B#4F53
```

Alternately you can go to the git repo of () to find the some of the theme's for debuggers.

## Strategy of examining the binary

### Review

1 - First review the file and understand its architecture (ELF, EXE, BAT, ...)
  1.1 - Another way to gain insight into the binary is to see the names of the functions that the binary uses. The following one-liner will do just that. Execute the command `readelf -a $FILE | grep FUNC | grep -vi glibc`
2 - If ELF, change its execution mode `chmod +x $FILE` and then execute
3 - Requires an input?
  3.1 - Give some randomg strings and try to observe the behaviour.
      `python -c "print('A'*180)" | ./vuln`  

4 - Is in a linux based portable executable? [Hacktricks has some quick guides for tinkering with the binary.](https://book.hacktricks.xyz/exploiting/linux-exploiting-basic-esp)
  4.1 - 
5 - Is the binary a windows based binary? [Hacktricks has some quick guides for tinkering with the binary.](https://book.hacktricks.xyz/exploiting/windows-exploiting-basic-guide-oscp-lvl)
  5.1 - 

### Cheating and Quick Wins

- Need a one line for MSFVENOM patterns and stuff: [MSF VENOM Cheat Sheet](/ExploitDevelopment/venom_cheatsheet.md)

- Python tricks for Encoding/Decoding; getting address in hex format in python

  ```python
  from pwn import *
  p32(0x080491e2)
  ```
